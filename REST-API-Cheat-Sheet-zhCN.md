# REST API 设计速查表

## 版权

以下所有内容皆来自图书《REST API Design Rulebook》，版权归作者和出版社所有。

## 设计原则

### URI 格式

* 应使用正斜线（/）来表示层级关系

* 不应在 URI 的结尾添加正斜线（/）

* 应使用连字符（-）来提高 URI 的可读性

* 不应使用下划线

* 在 URI 路径中小写字母优于大写字母

* URI 不应包含文件扩展名

### URI Authority 设计

* API 应使用一致的子域名

* 开发者门户网站应使用一致的子域名

### URI 路径设计

* 文档（document）名称应使用名词单数

* 集合（collection）名称应使用名词复数

* 仓库（store）名称应使用名词复数

* 控制器（controller）名称应使用动词或动词短语

* 路径中可以包含可变的片段，它们可以用具体的值替换

* URI 中不应出现 CRUD 函数名

### URI 查询字符串设计

* URI 的查询字符串部分可以用来从集合或仓库中过滤想要的信息

* URI 的查询字符串部分因该用来对集合或仓库结果进行分页

### 请求方法

* 不能用 GET 和 POST 来暗示（tunnel）其它请求方法

* 必须使用 GET 方法来获取某个资源的表征状态

* HEAD 方法应当用来获取响应的头部

* 必须使用 PUT 方法来新增或更新某个存储的资源

* 必须使用 PUT 来更新可变的资源

* 必须使用 POST 来为一个集合创建新资源

* 必须使用 POST 来执行控制器

* 必须使用 DELETE 来从一个母资源中删除子资源

* 应当使用 OPTIONS 来获取描述一个资源所允许交互方式的元数据

### 响应状态码

* 200 (OK) 应用来描述一般的成功响应

* 200 (OK) 不能用来在响应主体中传递错误

* 必须使用 201 (Created) 来描述成功的资源创建

* 必须使用 202 (Accepted) 来描述一个异步动作的成功开始

* 当响应主体有意留空时，应当使用 204 (No Content)

* 301 (Moved Permanently) 应用来重定位资源

* 不应使用 302 (Found)

* 303 (See Other) 应用来使客户端访问新 URI

* 应使用 304 (Not Modified) 来节省带宽

* 307 (Temporary Redirect) 应用于告知客户端将请求重新发送至另一个 URI

* 400 (Bad Request) 可以用来表示一般的请求失败

* 当客户端的凭证有问题时，必须使用 401 (Unauthorized)

* 403 (Forbidden) 应用于禁止访问，不论认证状态如何

* 当 URI 不能映射到某个资源时，必须使用 404 (Not Found)

* 当 HTTP 方法不受支持时，必须使用 405 (Method Not Allowed)

* 当请求的媒介类型不能提供时，必须使用 406 (Not Acceptable)

* 若请求对资源状态造成不可接受的改变，应使用 409 (Conflict)

* 应使用 412 (Precondition Failed) 来表示请求的前提条件未能满足

* 若服务器不能处理请求所携带数据的媒介类型，必须使用 415 (Unsupported Media Type)

* 500 (Internal Server Error) 应用来表示 API 非正常工作

### HTTP 头部

* 必须使用 Content-Type

* 应当使用 Content-Length

* 应当在响应中使用 Last-Modified

* 应当在响应中使用 ETag

* 仓库必须支持有条件的 PUT 请求

* 必须使用 Location 来表明新创建资源的 URI

* 为了缓存，应当使用 Cache-Control、Expires 和 Date 响应头部

* 为了不缓存，应当使用 Cache-Control、Expires 和 Pragma

* 鼓励使用缓存

* 过期的缓存头部应当使用 200 (OK) 响应

* 过期的缓存头部也可以使用 3xx 和 4xx 响应

* 不能用自定义的 HTTP 头部更改 HTTP 方法的行为

### 媒介类型设计

* 应当使用具有应用特殊性的媒介类型

* 当资源具有多种表征形态时，应支持媒介类型协商

* 查询字符串可以用来选择媒介类型

### 消息主体格式

* 应当支持以 JSON 作为资源的表征形态

* JSON 必须具有良好的格式

* XML 或其它格式也可以作为资源的表征形态

### 超媒体表征

* 应当使用一致的格式来表征链接

* 应当使用一致的格式来表征链接关系

* 应当使用一致的格式来宣告链接的存在

* 消息主体中应当包含 self 链接

* 作为入口的 API URIs 的数量应尽可能少

* 链接应当以一种对状态敏感的方式宣告资源的允许动作

### 媒介类型表征

* 应当使用一致的类型来表征媒介格式

* 应当使用一致的类型来表征媒介的 schema

### 错误表征

* 应当使用一致的格式来表现错误

* 应当使用一致的格式来表现错误的响应

* 常见的错误情形应当使用一致的错误类型

### 版本

* 新 URI 应当用来暴露新的资源

* 应当使用 Schema 来管理资源表征格式的版本

* 应当使用 ETag 来管理表征状态的版本

### 安全

* 可以使用 OAuth 协议保护资源

* 可以使用 API 管理方案保护资源

### 响应表征形态组成

* URI 的查询字符串部分应当能够过滤响应，返回所需要的部分

* URI 的查询字符串部分应当能够在响应中嵌入链接的资源

### JavaScript 客户端

* 为了对多个源（origin）的 JavaScript 提供写权限，应当支持 JSONP

* 为了对多个源（origin）的 JavaScript 提供读/写权限，应当支持 CORS
